module: "Kubernetes"
name: "Container Mem Usage"
filtering: "not filter('kubernetes_namespace','ara') and not filter('kubernetes_namespace','bastions') and not filter('kubernetes_namespace','gitlab-runner') and not filter('kubernetes_namespace','logging') and not filter('kubernetes_namespace','monitoring') and not filter('kubernetes_namespace','ingress-nginx') and not filter('kubernetes_namespace','kube-system') and not filter('kubernetes_namespace','kubernetes-replicator')"
aggregation: ".sum(by=['kubernetes_pod_name','kubernetes_namespace'])"
transformation: ".mean(over='30m')"
value_unit: "%"
signals:
  kubernetes_container_mem_limit:
    metric: "kubernetes.container_memory_limit"
  kubernetes_container_mem_utilization:
    metric: "container_memory_usage_bytes"
  signal:
    formula:
      (kubernetes_container_mem_utilization/kubernetes_container_mem_limit).scale(100)
rules:
  minor:
    threshold: 95
    comparator: ">"
  warning:
    threshold: 90
    comparator: ">"
    dependency: minor